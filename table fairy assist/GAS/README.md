# 테이블 요정 어시스트 - Google Apps Script 버전

## 📋 개요
Google Sheets와 Google Apps Script를 활용한 테이블 요정 웹 애플리케이션입니다.

## 🚀 설치 방법

### 1단계: Google Sheets 생성

1. 새 Google Sheets 생성
2. 스프레드시트 이름: `테이블 요정 어시스트 데이터`

### 2단계: 시트 구조 만들기

#### Sheet 1: `artist_list`
다음 열(컬럼)을 생성하세요:
```
A: 구분
B: 분류
C: 부문
D: URL
E: 작가명
F: 작가 UUID
```

**데이터 예시:**
```
구분     | 분류      | 부문      | URL                              | 작가명      | 작가 UUID
수상작가 | 판매 우수 | 가죽공예  | https://www.idus.com/... | 아비엥또    | a13ad97f-8917-469f-867b-d19c2d6dd5c1
초청작가 |           | 도자기    | https://www.idus.com/... | 여누즈      | 25cee04d-d3f9-48d5-9fce-19fd0e4476b7
```

#### Sheet 2: `table_info`
다음 열(컬럼)을 생성하세요:
```
A: 테이블
B: 테요1
C: 테요2
D: 작가
E: 작가 UUID
F: 작가홈 링크
G: 작품 리스트
```

**데이터 예시:**
```
테이블           | 테요1  | 테요2  | 작가      | 작가 UUID                              | 작가홈 링크     | 작품 리스트
작가 테이블 1   | 한진주 | 김다정 | 아비엥또  | a13ad97f-8917-469f-867b-d19c2d6dd5c1  | 작가 프로필    | 작품 리스트
작가 테이블 1   | 한진주 | 김다정 | 여누즈    | 25cee04d-d3f9-48d5-9fce-19fd0e4476b7  | 작가 프로필    | 작품 리스트
```

**중요:** 
- 기존 CSV 파일 데이터를 복사하여 붙여넣으면 됩니다
- 첫 번째 행은 반드시 헤더(컬럼명)여야 합니다

### 3단계: 스프레드시트 ID 확인

1. 스프레드시트 URL을 확인하세요
   ```
   https://docs.google.com/spreadsheets/d/[스프레드시트ID]/edit
   ```
2. `/d/` 와 `/edit` 사이의 문자열이 스프레드시트 ID입니다
3. 이 ID를 복사해두세요

### 4단계: Apps Script 프로젝트 생성

1. 스프레드시트에서 `확장 프로그램` > `Apps Script` 클릭
2. 새 프로젝트가 열립니다
3. 프로젝트 이름: `테이블 요정 어시스트`

### 5단계: 파일 추가

1. **Code.gs 수정**
   - 기본 `Code.gs` 파일의 내용을 모두 삭제
   - 이 폴더의 `Code.gs` 내용을 복사하여 붙여넣기
   - **중요:** 3번째 줄의 `YOUR_SPREADSHEET_ID_HERE`를 3단계에서 복사한 스프레드시트 ID로 변경
   ```javascript
   const SPREADSHEET_ID = '실제_스프레드시트_ID를_여기에_붙여넣으세요';
   ```

2. **index.html 추가**
   - 왼쪽 `+` 버튼 클릭 > `HTML` 선택
   - 파일 이름: `index`
   - 이 폴더의 `index.html` 내용을 복사하여 붙여넣기

3. **저장**
   - 모든 파일 저장 (`Ctrl + S` 또는 디스켓 아이콘 클릭)

### 6단계: 테스트

1. Apps Script 에디터 상단에서 `testGetData` 함수 선택
2. `실행` 버튼 클릭
3. 권한 승인 팝업이 나타나면:
   - `권한 검토` 클릭
   - 본인 Google 계정 선택
   - `고급` > `테이블 요정 어시스트(안전하지 않음)로 이동` 클릭
   - `허용` 클릭
4. 실행 로그에서 데이터가 정상적으로 읽히는지 확인

### 7단계: 웹 앱 배포

1. Apps Script 에디터 우측 상단 `배포` > `새 배포` 클릭
2. 설정:
   - **유형 선택**: `웹 앱`
   - **설명**: `테이블 요정 어시스트 v1.0`
   - **실행 권한**: `나`
   - **액세스 권한**: 
     * `모든 사용자` (누구나 접근 가능) 
     * 또는 `도메인 내 사용자` (회사 내부만)
3. `배포` 클릭
4. **웹 앱 URL 복사** - 이 URL을 테이블 요정들에게 공유하세요!

## 📱 사용 방법

1. 배포된 웹 앱 URL을 모바일/PC 브라우저에서 열기
2. 테이블 탭을 클릭하여 각 테이블의 작가 확인
3. 작가 카드를 클릭하여 상세 정보 펼치기
4. 검색창에서 작가명 또는 요정 이름 검색
5. `📖 요정 가이드` 버튼으로 행사 진행 가이드 확인

## 🔄 데이터 업데이트 방법

1. Google Sheets에서 데이터 수정
2. 저장 (자동 저장됨)
3. 웹 앱 새로고침하면 변경사항 반영!

**별도의 스크립트 실행이나 재배포가 필요 없습니다!**

## ⚙️ 재배포가 필요한 경우

다음의 경우에만 재배포가 필요합니다:
- `Code.gs` 또는 `index.html` 파일을 수정한 경우
- 권한 설정을 변경하는 경우

재배포 방법:
1. `배포` > `배포 관리` 클릭
2. 연필 아이콘(수정) 클릭
3. `버전` 옆 `새 버전` 선택
4. `배포` 클릭

## 🐛 문제 해결

### "데이터 로드 오류" 메시지가 표시될 때
1. `Code.gs`의 `SPREADSHEET_ID`가 올바른지 확인
2. 시트 이름이 정확히 `artist_list`, `table_info`인지 확인
3. 스프레드시트에 데이터가 있는지 확인

### 권한 오류가 발생할 때
1. Apps Script 에디터에서 `testGetData` 함수를 다시 실행
2. 권한 재승인

### 웹 앱 URL이 작동하지 않을 때
1. 배포 시 `액세스 권한`이 올바르게 설정되었는지 확인
2. 시크릿/프라이빗 브라우징 모드에서 테스트

## 📂 파일 구조

```
GAS/
├── Code.gs           # Apps Script 백엔드
├── index.html        # 프론트엔드 (HTML + CSS + JS 통합)
└── README.md         # 이 파일
```

## 💡 팁

- **북마크**: 웹 앱 URL을 모바일 홈화면에 추가하면 앱처럼 사용 가능
- **오프라인**: 한 번 로드 후에는 일부 기능이 오프라인에서도 작동 (캐시)
- **공유**: URL만 공유하면 누구나 사용 가능 (스프레드시트 공유 불필요)
- **보안**: 액세스 권한을 도메인 내로 제한하면 회사 사람들만 접근 가능

## 📞 지원

문제가 발생하거나 추가 기능이 필요한 경우 개발자에게 문의하세요.
